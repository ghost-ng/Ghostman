<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Specter Help - Complete User Guide</title>
    <link rel="stylesheet" href="css/help.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <h1><img src="../avatar.png" alt="Specter Avatar" style="width: 32px; height: 32px; vertical-align: middle; margin-right: 8px; border-radius: 50%;"> Specter</h1>
                    <span class="version">Complete User Guide - Your AI Desktop Companion</span>
                </div>
                <nav class="nav">
                    <a href="#installation" class="nav-link">Installation</a>
                    <a href="#interface" class="nav-link">Interface</a>
                    <a href="#features" class="nav-link">Features</a>
                    <a href="#skills" class="nav-link">Skills & Tools</a>
                    <a href="#workflows" class="nav-link">Workflows</a>
                    <a href="#settings" class="nav-link">Settings</a>
                    <a href="technical.html" class="nav-link" style="color: var(--accent-color);">Technical Docs</a>
                </nav>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-content">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search help...">
                </div>

                <nav class="sidebar-nav">
                    <div class="nav-section">
                        <h3>Getting Started</h3>
                        <ul>
                            <li><a href="#installation">Installation</a></li>
                            <li><a href="#first-setup">First Time Setup</a></li>
                            <li><a href="#api-keys">API Keys</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>User Workflows</h3>
                        <ul>
                            <li><a href="#starting-conversation">Starting Conversations</a></li>
                            <li><a href="#uploading-files">Uploading Files</a></li>
                            <li><a href="#file-context-search">File Context Search</a></li>
                            <li><a href="#managing-tabs">Managing Tabs</a></li>
                            <li><a href="#exporting-conversations">Exporting</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>Interface Overview</h3>
                        <ul>
                            <li><a href="#main-window">Main Window</a></li>
                            <li><a href="#spector-avatar">Specter Avatar</a></li>
                            <li><a href="#tab-management">Tab Management</a></li>
                            <li><a href="#file-browser">File Browser Bar</a></li>
                            <li><a href="#search-interface">Search Interface</a></li>
                            <li><a href="#system-tray">System Tray & Menus</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>Core Features</h3>
                        <ul>
                            <li><a href="#chat-interface">Chat Interface</a></li>
                            <li><a href="#conversation-system">Tabbed Conversations</a></li>
                            <li><a href="#file-context">File Context System</a></li>
                            <li><a href="#conversation-management">Conversation Management</a></li>
                            <li><a href="#slash-commands">Slash Commands</a></li>
                            <li><a href="#mentions">@ Mentions</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>Skills & Tools</h3>
                        <ul>
                            <li><a href="#skills">AI Skills Overview</a></li>
                            <li><a href="#skill-email">Email & Calendar</a></li>
                            <li><a href="#skill-files">File & Web Search</a></li>
                            <li><a href="#skill-capture">Screen Capture</a></li>
                            <li><a href="#skill-tasks">Task Tracker</a></li>
                            <li><a href="#skill-docx">DOCX Formatter</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>Avatar Personas</h3>
                        <ul>
                            <li><a href="#personas">Persona Overview</a></li>
                            <li><a href="#persona-list">Available Personas</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>Collections</h3>
                        <ul>
                            <li><a href="#collections">Collections Overview</a></li>
                            <li><a href="#collection-usage">Using Collections</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>Customization</h3>
                        <ul>
                            <li><a href="#themes">39 Themes</a></li>
                            <li><a href="#ai-models">AI Models</a></li>
                            <li><a href="#settings-tabs">Settings Tabs</a></li>
                            <li><a href="#advanced-settings">Advanced Settings</a></li>
                        </ul>
                    </div>

                    <div class="nav-section">
                        <h3>Reference</h3>
                        <ul>
                            <li><a href="#hotkeys">Keyboard Shortcuts</a></li>
                            <li><a href="#troubleshooting">Troubleshooting</a></li>
                            <li><a href="technical.html">Technical Documentation</a></li>
                        </ul>
                    </div>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Welcome Section -->
            <section id="welcome" class="content-section">
                <div class="hero">
                    <h1>Specter Complete Guide</h1>
                    <p class="hero-subtitle">Your comprehensive guide to mastering Specter, your intelligent AI desktop companion with AI skills, context-aware file search, avatar personas, tabbed conversations, and beautiful theming.</p>

                    <div class="hero-features">
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F916;</span>
                            <span>Multi-AI Support</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F47B;</span>
                            <span>Floating Avatar</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F4D1;</span>
                            <span>Tabbed Conversations</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F4C1;</span>
                            <span>File Context Search</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F3A8;</span>
                            <span>39 Beautiful Themes</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F9E0;</span>
                            <span>AI Skills & Tools</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F3AD;</span>
                            <span>Avatar Personas</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">&#x1F50D;</span>
                            <span>Advanced Search</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- User Workflows Section -->
            <section id="workflows" class="content-section">
                <h2>User Workflows</h2>
                <p>Learn step-by-step how to accomplish common tasks in Specter.</p>

                <div id="starting-conversation" class="subsection">
                    <h3>Starting a New Conversation</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Quick Start</h4>
                            <ol class="step-list">
                                <li>Click the Specter avatar to open the chat window</li>
                                <li>Type your message in the input box at the bottom</li>
                                <li>Press <kbd>Enter</kbd> to send</li>
                                <li>Watch as Specter responds in real-time</li>
                            </ol>
                            <div class="info-box" style="margin-top: 1rem;">
                                <p><strong>Tip:</strong> Use <kbd>Shift</kbd>+<kbd>Enter</kbd> to add line breaks without sending the message.</p>
                            </div>
                        </div>

                        <div class="feature-card">
                            <h4>Creating Multiple Tabs</h4>
                            <ol class="step-list">
                                <li>Click the <strong>+</strong> button in the tab bar</li>
                                <li>Or press <kbd>Ctrl</kbd>+<kbd>N</kbd> for a new tab</li>
                                <li>Each tab has its own conversation context</li>
                                <li>Switch between tabs by clicking them</li>
                                <li>Tabs auto-save and restore on restart</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <div id="uploading-files" class="subsection">
                    <h3>Uploading Files for Context-Aware Chat</h3>
                    <div class="screenshot">
                        <img src="images/file_browser_bar.png" alt="File browser bar showing upload buttons and file management">
                        <p class="caption">File browser bar with upload, clear, and hide/show controls</p>
                    </div>

                    <div class="screenshot">
                        <img src="images/file_context_rag.png" alt="File badges showing uploaded files with status">
                        <p class="caption">File badges displaying uploaded file names with visual status indicators</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Two Ways to Upload Files</h4>
                            <ol class="step-list">
                                <li><strong>Method 1 - Click Upload Button:</strong>
                                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                                        <li>Click the attach/upload icon in the file browser bar</li>
                                        <li>Select one or more files from the file picker dialog</li>
                                        <li>Files are added to the current conversation's context</li>
                                    </ul>
                                </li>
                                <li><strong>Method 2 - Drag and Drop:</strong>
                                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                                        <li>Drag files directly from your file explorer</li>
                                        <li>Drop them anywhere in the Specter window</li>
                                        <li>Files are automatically added and processed</li>
                                        <li>No clicking required - fastest method!</li>
                                    </ul>
                                </li>
                                <li><strong>Wait for Processing:</strong> Files are automatically embedded using AI</li>
                                <li><strong>See File Badges:</strong> Uploaded files appear as color-coded badges</li>
                                <li><strong>Start Querying:</strong> Ask questions about your uploaded content</li>
                            </ol>
                        </div>

                        <div class="feature-card">
                            <h4>Supported File Types</h4>
                            <ul>
                                <li><strong>Text Files:</strong> .txt, .md (markdown)</li>
                                <li><strong>Documents:</strong> .pdf, .docx, .rtf</li>
                                <li><strong>Web Content:</strong> .html, .htm</li>
                                <li><strong>Code Files:</strong> .py, .js, .java, .cpp, .go, .rs</li>
                                <li><strong>Max Size:</strong> 50MB per file</li>
                            </ul>
                            <div class="info-box" style="margin-top: 1rem;">
                                <p><strong>Note:</strong> Files are processed using AI embeddings for semantic search.</p>
                            </div>
                        </div>

                        <div class="feature-card">
                            <h4>Understanding File Badges</h4>
                            <p style="margin-bottom: 1rem;">Each uploaded file is displayed as a badge showing:</p>
                            <ul>
                                <li><strong>File Name:</strong> Truncated if too long (hover for full name)</li>
                                <li><strong>Status Indicator:</strong> Visual feedback on processing state</li>
                                <li><strong>Toggle Button:</strong> Enable/disable file in current context</li>
                                <li><strong>Remove Button (x):</strong> Delete file from conversation</li>
                            </ul>
                            <p style="margin-top: 1rem;"><strong>Badge Colors:</strong></p>
                            <ul>
                                <li><strong>Green:</strong> Successfully processed and ready</li>
                                <li><strong>Yellow/Amber:</strong> Processing or pending</li>
                                <li><strong>Red:</strong> Processing failed (hover for error details)</li>
                                <li><strong>Gray:</strong> Disabled (not included in context)</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Managing Uploaded Files</h4>
                            <ul>
                                <li><strong>View Files:</strong> All uploaded files show as badges</li>
                                <li><strong>Remove Files:</strong> Click the X on any file badge</li>
                                <li><strong>Clear All:</strong> Use the clear button to remove all files</li>
                                <li><strong>Hide/Show Bar:</strong> Toggle file browser visibility</li>
                                <li><strong>Conversation Isolation:</strong> Files are specific to each tab/conversation</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="file-context-search" class="subsection">
                    <h3>Using File Context Search</h3>
                    <div class="screenshot">
                        <img src="images/file_context_searching.png" alt="File context search results showing retrieved content">
                        <p class="caption">AI response using context from uploaded files with source citations</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>What is File Context Search?</h4>
                            <p>File context search uses RAG (Retrieval-Augmented Generation) to enhance AI responses with content from your uploaded files.</p>
                            <ul>
                                <li><strong>Semantic Search:</strong> Finds relevant content by meaning, not just keywords</li>
                                <li><strong>Source Citations:</strong> Shows which files were used</li>
                                <li><strong>Context-Aware:</strong> AI understands your documents</li>
                                <li><strong>Fast Retrieval:</strong> FAISS vector search for instant results</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>How to Query Your Files</h4>
                            <ol class="step-list">
                                <li><strong>Upload Files:</strong> First, upload documents you want to query</li>
                                <li><strong>Wait for Processing:</strong> Ensure files show "completed" status</li>
                                <li><strong>Ask Questions:</strong> Type questions about the content</li>
                                <li><strong>Get Enhanced Answers:</strong> AI retrieves relevant sections automatically</li>
                                <li><strong>See Sources:</strong> View which documents were referenced</li>
                            </ol>
                        </div>

                        <div class="feature-card">
                            <h4>Example Queries</h4>
                            <ul>
                                <li>"What are the main findings in the research paper?"</li>
                                <li>"Summarize the key points from chapter 3"</li>
                                <li>"Find all mentions of user authentication"</li>
                                <li>"Compare the pricing models discussed"</li>
                                <li>"What does the documentation say about installation?"</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Best Practices</h4>
                            <ul>
                                <li><strong>Specific Questions:</strong> More specific queries get better results</li>
                                <li><strong>Related Documents:</strong> Upload related files together</li>
                                <li><strong>File Organization:</strong> Use separate conversations for different topics</li>
                                <li><strong>Check Sources:</strong> Review cited sources for accuracy</li>
                                <li><strong>Reupload if Needed:</strong> Clear and reupload for fresh context</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="managing-tabs" class="subsection">
                    <h3>Managing Multiple Conversations in Tabs</h3>
                    <div class="screenshot">
                        <img src="images/titlebar_tabs.png" alt="Tab management interface showing multiple conversation tabs">
                        <p class="caption">Tab interface for managing multiple isolated conversations</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Tab Operations</h4>
                            <ul>
                                <li><strong>Create Tab:</strong> Click + or press <kbd>Ctrl</kbd>+<kbd>N</kbd></li>
                                <li><strong>Switch Tabs:</strong> Click any tab to switch</li>
                                <li><strong>Close Tab:</strong> Click X on tab or press <kbd>Ctrl</kbd>+<kbd>X</kbd></li>
                                <li><strong>Rename Tab:</strong> Right-click tab for options</li>
                                <li><strong>Reorder Tabs:</strong> Drag tabs to rearrange</li>
                                <li><strong>Next/Previous Tab:</strong> <kbd>Ctrl</kbd>+<kbd>Tab</kbd> / <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Tab</kbd></li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Conversation Isolation</h4>
                            <p>Each tab maintains completely separate context:</p>
                            <ul>
                                <li><strong>Independent AI Context:</strong> Conversation history isolated</li>
                                <li><strong>Separate File Context:</strong> Uploaded files unique to each tab</li>
                                <li><strong>Individual Settings:</strong> Each conversation has own state</li>
                                <li><strong>Auto-Save:</strong> All tabs saved automatically</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="exporting-conversations" class="subsection">
                    <h3>Exporting and Sharing Conversations</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>How to Export</h4>
                            <ol class="step-list">
                                <li>Click the save button in the title bar</li>
                                <li>Or press <kbd>Ctrl</kbd>+<kbd>S</kbd></li>
                                <li>Choose export format from menu</li>
                                <li>Select destination folder</li>
                                <li>File is saved with conversation title</li>
                            </ol>
                        </div>

                        <div class="feature-card">
                            <h4>Export Formats</h4>
                            <ul>
                                <li><strong>JSON:</strong> Complete data with metadata</li>
                                <li><strong>TXT:</strong> Plain text for simple sharing</li>
                                <li><strong>Markdown:</strong> Formatted with structure</li>
                                <li><strong>HTML:</strong> Web-ready with styling</li>
                                <li><strong>PDF:</strong> Professional document format</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="customizing-themes" class="subsection">
                    <h3>Customizing Themes and Appearance</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Changing Themes</h4>
                            <ol class="step-list">
                                <li>Click the gear icon or press <kbd>Ctrl</kbd>+<kbd>,</kbd></li>
                                <li>Navigate to "Interface" tab</li>
                                <li>Browse 39 available themes in dropdown</li>
                                <li>Select theme to preview instantly</li>
                                <li>Click "Apply" to save changes</li>
                            </ol>
                        </div>

                        <div class="feature-card">
                            <h4>Additional Customization</h4>
                            <ul>
                                <li><strong>Window Opacity:</strong> Adjust transparency (20-100%)</li>
                                <li><strong>Font Selection:</strong> Customize AI response fonts</li>
                                <li><strong>Always on Top:</strong> Keep window above others</li>
                                <li><strong>Window Size:</strong> Resize using corner/edge handles</li>
                                <li><strong>Avatar Persona:</strong> Choose from 8 AI personalities</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Installation -->
            <section id="installation" class="content-section">
                <h2>Installation</h2>

                <div class="info-box">
                    <p><strong>Requirements:</strong> Python 3.12+ and Windows 10/11</p>
                </div>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>Download & Setup</h4>
                        <div class="code-block">
                            <pre><code>git clone https://github.com/ghost-ng/Ghostman.git
cd Ghostman
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt</code></pre>
                        </div>
                    </div>

                    <div class="feature-card">
                        <h4>Run Specter</h4>
                        <div class="code-block">
                            <pre><code>python -m specter</code></pre>
                        </div>
                        <p>For debug mode:</p>
                        <div class="code-block">
                            <pre><code>python -m specter --debug</code></pre>
                        </div>
                    </div>
                </div>

                <div id="first-setup" class="subsection">
                    <h3>First Time Setup</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Initial Configuration</h4>
                            <ol class="step-list">
                                <li>Launch Specter - the avatar appears on your desktop</li>
                                <li>Click the avatar to open the chat window</li>
                                <li>Open Settings (gear icon or <kbd>Ctrl</kbd>+<kbd>,</kbd>)</li>
                                <li>Go to the "AI Settings" tab</li>
                                <li>Select a model preset or configure a custom endpoint</li>
                                <li>Enter your API key</li>
                                <li>Click "Apply" to save</li>
                            </ol>
                        </div>

                        <div class="feature-card">
                            <h4>Data Storage</h4>
                            <p>All Specter data is stored in Windows AppData:</p>
                            <div class="code-block">
                                <pre><code>%APPDATA%\Specter\
  configs\settings.json    # All settings
  db\conversations.db      # Conversation database
  logs\specter.log         # Application log
  logs\crash.log           # Crash traces
  pki\                     # PKI certificates
  captures\                # Screen captures
  rag\                     # RAG vector data</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="api-keys" class="subsection">
                    <h3>Get Your API Key</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>API Providers</h4>
                            <ul>
                                <li><strong>OpenAI:</strong> <a href="https://platform.openai.com/" target="_blank">platform.openai.com</a></li>
                                <li><strong>Anthropic:</strong> <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a></li>
                                <li><strong>Google:</strong> <a href="https://makersuite.google.com/" target="_blank">makersuite.google.com</a></li>
                                <li><strong>OpenRouter:</strong> <a href="https://openrouter.ai/" target="_blank">openrouter.ai</a></li>
                                <li><strong>Custom:</strong> Any OpenAI-compatible endpoint</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Key Features</h4>
                            <ul>
                                <li>Real-time AI response streaming</li>
                                <li>Enhanced markdown formatting</li>
                                <li>Code syntax highlighting</li>
                                <li>Copy individual messages</li>
                                <li>AI tool calling with skills</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Interface Overview -->
            <section id="interface" class="content-section">
                <h2>Interface Overview</h2>

                <div id="main-window" class="subsection">
                    <h3>Main Window</h3>
                    <div class="screenshot">
                        <img src="images/appwindow.png" alt="Specter main window showing chat interface">
                        <p class="caption">The Specter main window with tab bar, chat display, and input area</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Window Features</h4>
                            <ul>
                                <li><strong>Attach Mode:</strong> REPL window attaches to avatar (link icon)</li>
                                <li><strong>Pin Mode:</strong> Always-on-top toggle</li>
                                <li><strong>Resize:</strong> Edge and corner drag handles</li>
                                <li><strong>Position Memory:</strong> Window position and size remembered between sessions</li>
                                <li><strong>Opacity Control:</strong> Adjustable transparency</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Title Bar Controls</h4>
                            <div class="screenshot">
                                <img src="images/titlebar.png" alt="Title bar with action buttons">
                                <p class="caption">Title bar with attach, pin, settings, save, and minimize buttons</p>
                            </div>
                            <ul>
                                <li><strong>Attach (Link Icon):</strong> Attach/detach REPL from avatar</li>
                                <li><strong>Pin:</strong> Toggle always-on-top mode</li>
                                <li><strong>Settings (Gear):</strong> Open settings dialog</li>
                                <li><strong>Save:</strong> Export current conversation</li>
                                <li><strong>Minimize:</strong> Minimize to system tray</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="spector-avatar" class="subsection">
                    <h3>Specter Avatar</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Avatar Interactions</h4>
                            <ul>
                                <li><strong>Left Click:</strong> Show/hide the REPL chat window</li>
                                <li><strong>Right Click:</strong> Open context menu</li>
                                <li><strong>Drag:</strong> Move avatar anywhere on screen</li>
                                <li><strong>Animated States:</strong> Idle, sleeping, fidget animations</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Avatar Context Menu</h4>
                            <ul>
                                <li><strong>Conversations:</strong> Open the conversation browser</li>
                                <li><strong>Screen Capture:</strong> Start a screen capture</li>
                                <li><strong>Settings:</strong> Open settings dialog</li>
                                <li><strong>Help:</strong> Open this help documentation</li>
                                <li><strong>Minimize to Tray:</strong> Hide avatar to system tray</li>
                                <li><strong>Quit:</strong> Exit the application</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="system-tray" class="subsection">
                    <h3>System Tray & Avatar Menus</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>System Tray Menu</h4>
                            <p>Right-click the Specter icon in the Windows system tray:</p>
                            <ul>
                                <li><strong>Show Avatar:</strong> Restore the avatar to the desktop</li>
                                <li><strong>Screen Capture:</strong> Start a screen capture session</li>
                                <li><strong>Settings:</strong> Open the settings dialog</li>
                                <li><strong>Help:</strong> Open help documentation</li>
                                <li><strong>Quit:</strong> Exit the application completely</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Avatar Right-Click Menu</h4>
                            <p>Right-click the floating avatar on your desktop:</p>
                            <ul>
                                <li><strong>Conversations:</strong> Browse and manage saved conversations</li>
                                <li><strong>Screen Capture:</strong> Capture a region of your screen</li>
                                <li><strong>Settings:</strong> Open full settings dialog</li>
                                <li><strong>Help:</strong> Open this help guide</li>
                                <li><strong>Minimize to Tray:</strong> Hide avatar to system tray</li>
                                <li><strong>Quit:</strong> Exit the application</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="tab-management" class="subsection">
                    <h3>Tab Management</h3>
                    <div class="screenshot">
                        <img src="images/titlebar_tabs.png" alt="Tab bar showing multiple conversation tabs">
                        <p class="caption">Tab bar for managing multiple conversations</p>
                    </div>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Tab Controls</h4>
                            <ul>
                                <li><strong>New Tab (+):</strong> Create a new conversation (<kbd>Ctrl</kbd>+<kbd>N</kbd>)</li>
                                <li><strong>Close Tab (X):</strong> Close the current tab (<kbd>Ctrl</kbd>+<kbd>X</kbd>)</li>
                                <li><strong>Switch Tabs:</strong> Click any tab or use <kbd>Ctrl</kbd>+<kbd>Tab</kbd></li>
                                <li><strong>Auto-Naming:</strong> Tabs auto-name based on conversation content</li>
                                <li><strong>Drag to Reorder:</strong> Drag tabs to change order</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="file-browser" class="subsection">
                    <h3>File Browser Bar</h3>
                    <div class="screenshot">
                        <img src="images/file_browser_bar.png" alt="File browser bar">
                        <p class="caption">File browser bar with upload and management controls</p>
                    </div>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>File Browser Controls</h4>
                            <ul>
                                <li><strong>Upload Button:</strong> Select files for RAG processing</li>
                                <li><strong>Clear Button:</strong> Remove all files from context</li>
                                <li><strong>Toggle Visibility:</strong> Show/hide with <kbd>Ctrl</kbd>+<kbd>U</kbd></li>
                                <li><strong>File Badges:</strong> Color-coded status indicators</li>
                                <li><strong>Per-Tab Isolation:</strong> Each tab has its own files</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="search-interface" class="subsection">
                    <h3>Search Interface</h3>
                    <div class="screenshot">
                        <img src="images/searchbar.png" alt="Search bar for finding messages">
                        <p class="caption">Search bar for finding messages within a conversation</p>
                    </div>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Search Features</h4>
                            <ul>
                                <li><strong>Open Search:</strong> Press <kbd>Ctrl</kbd>+<kbd>F</kbd></li>
                                <li><strong>Search Within:</strong> Find text in the current conversation</li>
                                <li><strong>Conversation Browser:</strong> <kbd>Ctrl</kbd>+<kbd>K</kbd> to search across all conversations</li>
                                <li><strong>Close Search:</strong> Press <kbd>Escape</kbd></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Core Features -->
            <section id="features" class="content-section">
                <h2>Core Features</h2>

                <div id="file-context" class="subsection">
                    <h3>File Context System (RAG)</h3>
                    <div class="info-box">
                        <p><strong>Powered by RAG Technology:</strong> Upload documents and query them using AI-powered semantic search. See <a href="technical.html#rag-architecture">Technical Documentation</a> for details.</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Key Capabilities</h4>
                            <ul>
                                <li><strong>Document Understanding:</strong> Upload PDFs, text, code files</li>
                                <li><strong>Semantic Search:</strong> AI finds relevant content by meaning</li>
                                <li><strong>Context-Aware Responses:</strong> Answers based on your documents</li>
                                <li><strong>Source Citations:</strong> See which files were referenced</li>
                                <li><strong>Conversation Isolation:</strong> Each tab has its own file context</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Technical Foundation</h4>
                            <ul>
                                <li><strong>FAISS Vector Store:</strong> Fast similarity search</li>
                                <li><strong>OpenAI Embeddings:</strong> text-embedding-3-small model</li>
                                <li><strong>Smart Chunking:</strong> 1000 char chunks, 200 char overlap</li>
                                <li><strong>Thread-Safe:</strong> Isolated RAG sessions per conversation</li>
                            </ul>
                            <p style="margin-top: 1rem;"><a href="technical.html">Learn more about the RAG architecture</a></p>
                        </div>
                    </div>
                </div>

                <div id="chat-interface" class="subsection">
                    <h3>Chat Interface</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Chat Features</h4>
                            <ul>
                                <li><strong>Real-time Streaming:</strong> Watch AI responses appear live</li>
                                <li><strong>Markdown Support:</strong> Rich text formatting and code highlighting</li>
                                <li><strong>Message History:</strong> Scroll to see previous conversations</li>
                                <li><strong>Copy Messages:</strong> Right-click any message to copy</li>
                                <li><strong>Multi-line Input:</strong> Shift+Enter for new lines without sending</li>
                                <li><strong>Clickable URLs:</strong> Links in responses open in your browser</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Input Controls</h4>
                            <ul>
                                <li><strong>Enter:</strong> Send message</li>
                                <li><strong>Shift+Enter:</strong> New line without sending</li>
                                <li><strong>Ctrl+Enter:</strong> Send message (alternative)</li>
                                <li><strong>Up/Down:</strong> Navigate message history</li>
                                <li><strong>Escape:</strong> Cancel streaming response</li>
                                <li><strong>/ (slash):</strong> Open command autocomplete</li>
                                <li><strong>@ (at sign):</strong> Open mention autocomplete</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="conversation-system" class="subsection">
                    <h3>Tabbed Conversation System</h3>
                    <div class="info-box">
                        <p><strong>Professional multi-conversation management</strong> with isolated contexts and smart organization.</p>
                    </div>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Tab Management</h4>
                            <ul>
                                <li><strong>New Tab:</strong> Click "+" for fresh conversations</li>
                                <li><strong>Switch Tabs:</strong> Click any tab to switch contexts</li>
                                <li><strong>Tab Titles:</strong> Auto-update with conversation content</li>
                                <li><strong>Context Isolation:</strong> Each tab maintains separate AI context</li>
                                <li><strong>File Isolation:</strong> Uploaded files unique to each conversation</li>
                                <li><strong>Auto-save:</strong> All conversations saved automatically</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Enhanced Save Functionality</h4>
                            <ul>
                                <li><strong>Title Bar Save Button:</strong> Instant access to save</li>
                                <li><strong>Theme-Aware Icons:</strong> Automatic dark/light adaptation</li>
                                <li><strong>Quick Save:</strong> No menu navigation required</li>
                                <li><strong>Export Options:</strong> Multiple format support</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="conversation-management" class="subsection">
                    <h3>Conversation Management</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Conversation Browser</h4>
                            <p>Open with <kbd>Ctrl</kbd>+<kbd>K</kbd> or from the avatar context menu.</p>
                            <ul>
                                <li><strong>Search:</strong> Find conversations by title or content</li>
                                <li><strong>Load:</strong> Open any saved conversation in a new tab</li>
                                <li><strong>Delete:</strong> Remove conversations you no longer need</li>
                                <li><strong>Pin:</strong> Mark important conversations for quick access</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Smart Saving</h4>
                            <ul>
                                <li><strong>Auto-Save:</strong> Conversations save after each message exchange</li>
                                <li><strong>No Empty Saves:</strong> Conversations are only saved after the first message</li>
                                <li><strong>Per-Tab State:</strong> Each tab's state is independently preserved</li>
                                <li><strong>Restore on Launch:</strong> Previous session tabs restore automatically</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="slash-commands" class="subsection">
                    <h3>Slash Commands</h3>
                    <div class="info-box">
                        <p><strong>Quick Tip:</strong> Typing <code>/</code> in the input box triggers an autocomplete popup showing all available commands.</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Standard Commands (Always Available)</h4>
                            <ul>
                                <li><strong>/help</strong> - Show available commands and usage info</li>
                                <li><strong>/clear</strong> - Clear the output display</li>
                                <li><strong>/history</strong> - Show last 10 commands from history</li>
                                <li><strong>/resend</strong> - Resend the last failed message</li>
                                <li><strong>/exit</strong> - Minimize the application to system tray</li>
                                <li><strong>/skills</strong> - Show available AI skills and tools</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Debug Commands (Advanced Settings)</h4>
                            <p>Enable debug mode in Settings &gt; Advanced to unlock these commands:</p>
                            <ul>
                                <li><strong>/quit</strong> - Exit the application entirely</li>
                                <li><strong>/context</strong> - Show AI context status and conversation info</li>
                                <li><strong>/render_stats</strong> - Show markdown rendering statistics</li>
                                <li><strong>/test_markdown</strong> - Test markdown rendering with sample content</li>
                                <li><strong>/test_themes</strong> - Cycle through all themes for testing</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="mentions" class="subsection">
                    <h3>@ Mentions System</h3>
                    <div class="info-box">
                        <p><strong>Quick Tip:</strong> Typing <code>@</code> in the input box triggers an autocomplete popup showing available mention targets.</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Collection Mentions</h4>
                            <p>Reference a saved collection to load its files into context:</p>
                            <div class="code-block">
                                <pre><code>@collection:my-research-papers</code></pre>
                            </div>
                            <ul>
                                <li>Loads all files from the named collection into the current conversation's RAG context</li>
                                <li>Autocomplete shows all available collections as you type</li>
                                <li>Combine with a question in the same message</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>URL Mentions</h4>
                            <p>Load webpage content temporarily into context:</p>
                            <div class="code-block">
                                <pre><code>@url:https://example.com/article</code></pre>
                            </div>
                            <ul>
                                <li>Fetches and processes the webpage content</li>
                                <li>Content is available as temporary context for the conversation</li>
                                <li>Useful for asking questions about web pages</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- AI Skills & Tools -->
            <section id="skills" class="content-section">
                <h2>AI Skills & Tools</h2>
                <p>Specter includes 9 AI-callable skills that the AI can invoke automatically when relevant to the conversation. Skills extend the AI beyond text chat into real-world actions like sending emails, searching files, capturing screens, and formatting documents.</p>

                <div class="info-box">
                    <p><strong>How it works:</strong> When you ask the AI to do something that matches a skill's capability, the AI automatically invokes the appropriate tool. You can also type <code>/skills</code> to see all available skills, or manage them in Settings &gt; Tools.</p>
                </div>

                <div id="skill-email" class="subsection">
                    <h3>Email & Calendar Skills</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Email Draft</h4>
                            <p>Create email drafts in Microsoft Outlook.</p>
                            <ul>
                                <li><strong>Draft Only:</strong> Emails are never auto-sent - always saved as drafts</li>
                                <li><strong>Full Control:</strong> Set To, CC, BCC, Subject, and Body</li>
                                <li><strong>HTML Support:</strong> Rich formatting in email body</li>
                                <li><strong>Safe by Design:</strong> You review and send manually from Outlook</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "Draft an email to john@example.com about the project status update"</p>
                        </div>

                        <div class="feature-card">
                            <h4>Email Search</h4>
                            <p>Search your Outlook mailbox or retrieve recent messages.</p>
                            <ul>
                                <li><strong>Keyword Search:</strong> Find emails matching search terms</li>
                                <li><strong>Recent Messages:</strong> Retrieve last N emails from inbox</li>
                                <li><strong>Folder Browsing:</strong> Search specific Outlook folders</li>
                                <li><strong>Rich Results:</strong> Returns subject, sender, date, and preview</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "Search my email for messages from Sarah about the budget"</p>
                        </div>

                        <div class="feature-card">
                            <h4>Calendar Event</h4>
                            <p>Create calendar appointments in Microsoft Outlook.</p>
                            <ul>
                                <li><strong>Draft Mode:</strong> Events are created as drafts you can review</li>
                                <li><strong>Full Details:</strong> Subject, location, start/end time, body</li>
                                <li><strong>Attendees:</strong> Add required and optional attendees</li>
                                <li><strong>Recurring:</strong> Set up recurring event patterns</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "Create a meeting for tomorrow at 2pm with the design team"</p>
                        </div>

                        <div class="feature-card">
                            <h4>Calendar Search</h4>
                            <p>Search your Outlook calendar for events.</p>
                            <ul>
                                <li><strong>Date Range:</strong> Find events within specific dates</li>
                                <li><strong>Keyword Search:</strong> Search by event subject or content</li>
                                <li><strong>Upcoming Events:</strong> View your next scheduled appointments</li>
                                <li><strong>Event Details:</strong> Returns full event information</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "What meetings do I have this week?"</p>
                        </div>
                    </div>
                </div>

                <div id="skill-files" class="subsection">
                    <h3>File & Web Search Skills</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>File Search</h4>
                            <p>Search files on your computer using the Windows Search API.</p>
                            <ul>
                                <li><strong>System-Wide:</strong> Searches across all indexed drives</li>
                                <li><strong>File Types:</strong> Filter by extension or content type</li>
                                <li><strong>Content Search:</strong> Find files containing specific text</li>
                                <li><strong>Results:</strong> Returns file paths, sizes, and dates</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "Find all PDF files related to quarterly reports"</p>
                        </div>

                        <div class="feature-card">
                            <h4>Web Search</h4>
                            <p>Search the web via DuckDuckGo or Tavily.</p>
                            <ul>
                                <li><strong>DuckDuckGo:</strong> Free, no API key required (default)</li>
                                <li><strong>Tavily:</strong> Higher quality results with API key</li>
                                <li><strong>Configurable:</strong> Set search provider in Settings &gt; Tools</li>
                                <li><strong>Content Extraction:</strong> Parses page content for context</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "Search the web for the latest Python 3.13 release notes"</p>
                        </div>
                    </div>
                </div>

                <div id="skill-capture" class="subsection">
                    <h3>Screen Capture Skill</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Screen Capture</h4>
                            <p>Capture regions of your screen with flexible selection modes.</p>
                            <ul>
                                <li><strong>Rectangle Selection:</strong> Draw a rectangular region</li>
                                <li><strong>Circle Selection:</strong> Capture a circular area</li>
                                <li><strong>Freeform Selection:</strong> Draw any shape to capture</li>
                                <li><strong>Auto-Copy:</strong> Capture is automatically copied to clipboard</li>
                                <li><strong>Save Option:</strong> Save captures to the captures folder</li>
                                <li><strong>AI Analysis:</strong> Send captures to AI for description or analysis</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Access:</strong> Right-click avatar &gt; Screen Capture, or system tray &gt; Screen Capture</p>
                        </div>
                    </div>
                </div>

                <div id="skill-tasks" class="subsection">
                    <h3>Task Tracker Skill</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Task Tracker</h4>
                            <p>Manage tasks and to-do items with a local SQLite database.</p>
                            <ul>
                                <li><strong>Create Tasks:</strong> Add new tasks with descriptions and priorities</li>
                                <li><strong>List Tasks:</strong> View all tasks filtered by status</li>
                                <li><strong>Complete Tasks:</strong> Mark tasks as done</li>
                                <li><strong>Delete Tasks:</strong> Remove tasks from the list</li>
                                <li><strong>Priority Levels:</strong> Low, Medium, High priority support</li>
                                <li><strong>Persistent Storage:</strong> Tasks survive application restarts</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "Add a task to review the Q4 budget with high priority"</p>
                        </div>
                    </div>
                </div>

                <div id="skill-docx" class="subsection">
                    <h3>DOCX Formatter Skill</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>DOCX Formatter</h4>
                            <p>Reformat and modify Word documents (.docx) with 11 supported operations.</p>
                            <ul>
                                <li><strong>Change Fonts:</strong> Update font family across the document</li>
                                <li><strong>Set Margins:</strong> Adjust page margins (inches)</li>
                                <li><strong>Line Spacing:</strong> Change line spacing (single, 1.5, double, custom)</li>
                                <li><strong>Bullet Lists:</strong> Convert paragraphs to bullet points</li>
                                <li><strong>Spell Check:</strong> Find and correct spelling errors</li>
                                <li><strong>Change Case:</strong> Convert text to upper, lower, or title case</li>
                                <li><strong>Format Headings:</strong> Apply heading styles to text</li>
                                <li><strong>Find/Replace:</strong> Search and replace text throughout</li>
                                <li><strong>Font Color:</strong> Change text color</li>
                                <li><strong>Alignment:</strong> Set paragraph alignment (left, center, right, justify)</li>
                                <li><strong>Indent:</strong> Adjust paragraph indentation</li>
                            </ul>
                            <p style="margin-top: 0.5rem;"><strong>Example:</strong> "Change the font in report.docx to Arial 12pt with 1-inch margins"</p>
                        </div>

                        <div class="feature-card">
                            <h4>Managing Skills</h4>
                            <p>Configure skills globally in Settings &gt; Tools:</p>
                            <ul>
                                <li><strong>Enable/Disable Tool Calling:</strong> Global toggle for all skills</li>
                                <li><strong>Max Iterations:</strong> Limit how many tool calls per message</li>
                                <li><strong>Web Search Provider:</strong> Choose DuckDuckGo or Tavily</li>
                                <li><strong>Tavily API Key:</strong> Enter key for Tavily web search</li>
                                <li><strong>DOCX Defaults:</strong> Set default font, margins, spacing</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Avatar Personas -->
            <section id="personas" class="content-section">
                <h2>Avatar Personas</h2>
                <p>Specter offers 8 selectable AI personalities, each with unique traits, system prompts, and communication styles. Choose a persona that matches your workflow and preferences.</p>

                <div class="info-box">
                    <p><strong>How to change:</strong> Open Settings &gt; Avatar tab to browse and select personas using the carousel interface.</p>
                </div>

                <div id="persona-list" class="subsection">
                    <h3>Available Personas</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Specter (Default)</h4>
                            <p><strong>Whimsical Productivity Companion</strong></p>
                            <ul>
                                <li>Friendly and approachable communication style</li>
                                <li>Balanced between professional and casual tone</li>
                                <li>Great all-around persona for everyday use</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Aegis</h4>
                            <p><strong>Strategic Productivity Partner</strong></p>
                            <ul>
                                <li>Focused on strategic thinking and planning</li>
                                <li>Structured, methodical communication</li>
                                <li>Best for project management and strategy work</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Opus</h4>
                            <p><strong>Systems-Oriented Architect</strong></p>
                            <ul>
                                <li>Technical and systems-thinking focused</li>
                                <li>Precise, detail-oriented responses</li>
                                <li>Best for engineering and architecture tasks</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Spark</h4>
                            <p><strong>Energetic Productivity Catalyst</strong></p>
                            <ul>
                                <li>High-energy, motivating communication</li>
                                <li>Action-oriented and fast-paced</li>
                                <li>Best for brainstorming and rapid ideation</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Sage</h4>
                            <p><strong>Calm & Reflective Guide</strong></p>
                            <ul>
                                <li>Thoughtful, measured responses</li>
                                <li>Wisdom-oriented approach to problems</li>
                                <li>Best for research and deep analysis</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Vector</h4>
                            <p><strong>Tactical Execution Partner</strong></p>
                            <ul>
                                <li>Direct, no-nonsense communication</li>
                                <li>Focused on execution and results</li>
                                <li>Best for task completion and operations</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Nova</h4>
                            <p><strong>Creative & Visionary Partner</strong></p>
                            <ul>
                                <li>Imaginative and creative communication</li>
                                <li>Excels at out-of-the-box thinking</li>
                                <li>Best for creative writing and design work</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Simon</h4>
                            <p><strong>Steady Operational Partner</strong></p>
                            <ul>
                                <li>Reliable, consistent communication style</li>
                                <li>Focused on process and routine</li>
                                <li>Best for daily workflows and standard tasks</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Collections -->
            <section id="collections" class="content-section">
                <h2>Collections</h2>
                <p>Collections let you organize files into named groups that can be reused across conversations. Think of them as persistent file bundles you can load into any conversation's context on demand.</p>

                <div id="collection-usage" class="subsection">
                    <h3>Using Collections</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Creating Collections</h4>
                            <ol class="step-list">
                                <li>Open the Collections Manager from the file browser bar</li>
                                <li>Click "New Collection" and give it a name</li>
                                <li>Add files to the collection by uploading or browsing</li>
                                <li>Files are processed through the RAG pipeline and embedded</li>
                                <li>The collection is saved and available across all conversations</li>
                            </ol>
                        </div>

                        <div class="feature-card">
                            <h4>Referencing Collections</h4>
                            <p>Load a collection into your current conversation using the @ mention syntax:</p>
                            <div class="code-block">
                                <pre><code>@collection:project-docs What are the API endpoints?</code></pre>
                            </div>
                            <ul>
                                <li><strong>Instant Context:</strong> All files in the collection are loaded into RAG</li>
                                <li><strong>Autocomplete:</strong> Typing <code>@collection:</code> shows available collections</li>
                                <li><strong>Combine with Questions:</strong> Ask about the collection in the same message</li>
                                <li><strong>Per-Conversation:</strong> Collections are loaded per-tab, maintaining isolation</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Managing Collections</h4>
                            <ul>
                                <li><strong>Add Files:</strong> Upload new files to existing collections</li>
                                <li><strong>Remove Files:</strong> Remove individual files from a collection</li>
                                <li><strong>Delete Collections:</strong> Remove entire collections and their data</li>
                                <li><strong>Tag System:</strong> Collections use tags for organization</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Best Practices</h4>
                            <ul>
                                <li><strong>Themed Groups:</strong> Group related documents (e.g., "Q4 Reports", "API Docs")</li>
                                <li><strong>Keep Focused:</strong> Smaller, focused collections yield better search results</li>
                                <li><strong>Update Regularly:</strong> Add new files as your project evolves</li>
                                <li><strong>Descriptive Names:</strong> Use clear names for easy autocomplete</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings -->
            <section id="settings" class="content-section">
                <h2>Settings</h2>
                <p>Specter's settings dialog has 8 tabs for comprehensive customization. Open with the gear icon or <kbd>Ctrl</kbd>+<kbd>,</kbd>.</p>

                <div id="settings-tabs" class="subsection">
                    <h3>Settings Tabs Overview</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>1. AI Settings</h4>
                            <div class="screenshot">
                                <img src="images/ai-settings.png" alt="AI Settings tab">
                                <p class="caption">AI model configuration with presets and API key</p>
                            </div>
                            <ul>
                                <li><strong>Model Presets:</strong> Quick-select from popular AI models</li>
                                <li><strong>Base URL:</strong> API endpoint URL</li>
                                <li><strong>API Key:</strong> Your provider's authentication key</li>
                                <li><strong>Temperature:</strong> Response creativity (0.0 = precise, 2.0 = creative)</li>
                                <li><strong>Max Tokens:</strong> Maximum response length</li>
                                <li><strong>System Prompt:</strong> Custom instructions for the AI</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>2. Interface</h4>
                            <div class="screenshot">
                                <img src="images/interface-settings.png" alt="Interface Settings tab">
                                <p class="caption">Interface customization with theme and opacity controls</p>
                            </div>
                            <ul>
                                <li><strong>Theme:</strong> Select from 39 themes in a dropdown</li>
                                <li><strong>Window Opacity:</strong> Adjust transparency (20-100%)</li>
                                <li><strong>Icon Size:</strong> Configure toolbar icon dimensions</li>
                                <li><strong>Always on Top:</strong> Keep Specter above other windows</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>3. Fonts</h4>
                            <div class="screenshot">
                                <img src="images/font-settings.png" alt="Font Settings tab">
                                <p class="caption">Font customization for AI responses and user input</p>
                            </div>
                            <ul>
                                <li><strong>Font Family:</strong> Choose any installed system font</li>
                                <li><strong>Font Size:</strong> Set text size for the chat display</li>
                                <li><strong>AI Response Font:</strong> Separate font for AI messages</li>
                                <li><strong>User Input Font:</strong> Font for the input area</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>4. Advanced</h4>
                            <div class="screenshot">
                                <img src="images/advanced-settings.png" alt="Advanced Settings tab">
                                <p class="caption">Advanced options for debugging and SSL</p>
                            </div>
                            <ul>
                                <li><strong>Debug Mode:</strong> Enable debug slash commands and verbose logging</li>
                                <li><strong>SSL Verification:</strong> Toggle SSL certificate verification</li>
                                <li><strong>AI Intent Classification:</strong> Enable/disable automatic skill matching</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>5. Themes</h4>
                            <div class="screenshot">
                                <img src="images/theme-settings.png" alt="Theme browser tab">
                                <p class="caption">Visual theme browser with live previews</p>
                            </div>
                            <ul>
                                <li><strong>Theme Browser:</strong> Visual gallery of all 39 themes</li>
                                <li><strong>Live Preview:</strong> See theme colors before applying</li>
                                <li><strong>Categories:</strong> Dark, light, nature, tech, creative themes</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>6. Tools</h4>
                            <ul>
                                <li><strong>Tool Calling Toggle:</strong> Enable/disable all AI tool calling globally</li>
                                <li><strong>Max Iterations:</strong> Limit tool call loops per message (safety)</li>
                                <li><strong>Web Search Config:</strong> Choose provider (DuckDuckGo or Tavily)</li>
                                <li><strong>Tavily API Key:</strong> Enter key for Tavily web search</li>
                                <li><strong>DOCX Formatter Defaults:</strong> Set default font, margins, and spacing</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>7. PKI Auth</h4>
                            <div class="screenshot">
                                <img src="images/pki-settings.png" alt="PKI authentication settings">
                                <p class="caption">PKI certificate management for enterprise authentication</p>
                            </div>
                            <ul>
                                <li><strong>Client Certificate:</strong> Upload .crt file for authentication</li>
                                <li><strong>Client Key:</strong> Upload .pem private key file</li>
                                <li><strong>CA Chain:</strong> Upload certificate authority chain</li>
                                <li><strong>PKI Wizard:</strong> Guided setup for PKI configuration</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>8. Avatar</h4>
                            <ul>
                                <li><strong>Persona Selector:</strong> Carousel interface to browse personas</li>
                                <li><strong>Persona Preview:</strong> See personality traits before selecting</li>
                                <li><strong>8 Personas:</strong> Specter, Aegis, Opus, Spark, Sage, Vector, Nova, Simon</li>
                                <li><strong>Instant Switch:</strong> Persona changes take effect immediately</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="ai-models" class="subsection">
                    <h3>AI Model Presets</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Anthropic Models</h4>
                            <ul>
                                <li><strong>Claude 3.5 Sonnet</strong> - Fast, capable general-purpose model</li>
                                <li><strong>Claude 3.5 Haiku</strong> - Fastest Anthropic model</li>
                                <li><strong>Claude 3 Opus</strong> - Most capable Anthropic model</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>OpenAI Models</h4>
                            <ul>
                                <li><strong>GPT-5 (Latest)</strong> - Latest flagship OpenAI model</li>
                                <li><strong>GPT-5-mini</strong> - Smaller, faster variant</li>
                                <li><strong>GPT-5-nano</strong> - Lightest variant</li>
                                <li><strong>GPT-4o</strong> - Optimized multimodal model</li>
                                <li><strong>o3-mini</strong> - Efficient reasoning model</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Google Models</h4>
                            <ul>
                                <li><strong>Gemini 2.5 Pro</strong> - Most capable Google model</li>
                                <li><strong>Gemini 2.5 Flash</strong> - Fast, efficient Google model</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>OpenAI Reasoning</h4>
                            <ul>
                                <li><strong>o1-preview</strong> - Advanced reasoning model</li>
                                <li><strong>o1-mini</strong> - Compact reasoning model</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Legacy Models</h4>
                            <ul>
                                <li><strong>GPT-4 Turbo</strong> - Previous generation flagship</li>
                                <li><strong>GPT-4o-mini</strong> - Compact previous generation</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>OpenRouter Models</h4>
                            <ul>
                                <li><strong>GPT-4o via OpenRouter</strong> - OpenAI through OpenRouter</li>
                                <li><strong>Claude 3.5 Sonnet via OpenRouter</strong> - Anthropic through OpenRouter</li>
                                <li><strong>Custom:</strong> Any OpenAI-compatible endpoint or model</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Themes -->
            <section id="themes" class="content-section">
                <h2>Themes (39 Total)</h2>
                <p>Choose from 39 professionally designed themes with automatic font matching, smart tab colors, and intelligent icon adaptation.</p>

                <div class="subsection">
                    <h3>Dark Themes (30)</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Tech & Programming</h4>
                            <ul>
                                <li><strong>dark_matrix:</strong> Matrix-inspired green on black</li>
                                <li><strong>cyberpunk:</strong> Neon green and blue tech aesthetic</li>
                                <li><strong>cyber:</strong> Full cyberpunk neon aesthetic</li>
                                <li><strong>ocean_deep:</strong> Deep sea blues</li>
                                <li><strong>midnight_blue:</strong> Deep blue professional theme</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Creative & Artistic</h4>
                            <ul>
                                <li><strong>sunset_orange:</strong> Warm orange and red tones</li>
                                <li><strong>royal_purple:</strong> Elegant purple theme</li>
                                <li><strong>fireswamp:</strong> Warm reds and oranges</li>
                                <li><strong>steampunk:</strong> Victorian copper and brass</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Nature & Environment</h4>
                            <ul>
                                <li><strong>forest_green:</strong> Natural green tones</li>
                                <li><strong>forest:</strong> Rich forest greens</li>
                                <li><strong>earth_tones:</strong> Brown and warm natural colors</li>
                                <li><strong>ocean:</strong> Ocean blue theme</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Pop Culture & Fandom</h4>
                            <ul>
                                <li><strong>dracula:</strong> Popular developer theme</li>
                                <li><strong>solarized_dark:</strong> Classic developer favorite</li>
                                <li><strong>gryffindor:</strong> Red and gold wizarding</li>
                                <li><strong>slytherin:</strong> Green and silver wizarding</li>
                                <li><strong>ravenclaw:</strong> Blue and bronze wizarding</li>
                                <li><strong>hufflepuff:</strong> Yellow and black wizarding</li>
                                <li><strong>empire:</strong> Imperial dark theme</li>
                                <li><strong>republic:</strong> Republic-inspired theme</li>
                                <li><strong>jedi:</strong> Light side of the Force</li>
                                <li><strong>sith:</strong> Dark side of the Force</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Aesthetic & Mood</h4>
                            <ul>
                                <li><strong>moonlight:</strong> Soft moonlit palette</li>
                                <li><strong>dusk:</strong> Evening twilight tones</li>
                                <li><strong>dawn:</strong> Early morning colors</li>
                                <li><strong>firefly:</strong> Warm glowing accents</li>
                                <li><strong>jade:</strong> Rich green jade tones</li>
                                <li><strong>pulse:</strong> Vibrant rhythmic theme</li>
                                <li><strong>winter:</strong> Cool icy palette</li>
                                <li><strong>mintly:</strong> Fresh mint accent theme</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3>Light Themes (9)</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Professional</h4>
                            <ul>
                                <li><strong>arctic_white:</strong> Clean professional look</li>
                                <li><strong>openai_like:</strong> OpenAI-inspired design</li>
                                <li><strong>openui_like:</strong> Modern UI theme</li>
                                <li><strong>openwebui_like:</strong> Open WebUI-inspired design</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Creative & Soft</h4>
                            <ul>
                                <li><strong>lilac:</strong> Soft purple light theme</li>
                                <li><strong>sunburst:</strong> Golden orange theme</li>
                                <li><strong>solarized_light:</strong> Popular light developer theme</li>
                                <li><strong>birthday_cake:</strong> Festive pastel colors</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Keyboard Shortcuts -->
            <section id="keyboard-shortcuts" class="content-section">
                <a id="hotkeys"></a>
                <h2>Keyboard Shortcuts</h2>
                <p>Master these shortcuts to boost your productivity with Specter.</p>

                <div class="shortcuts-grid">
                    <div class="shortcuts-category">
                        <h4>Chat Interface</h4>
                        <div class="shortcut-item">
                            <kbd>Enter</kbd>
                            <span>Send message</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>Enter</kbd>
                            <span>Send message (alternative)</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Shift</kbd> + <kbd>Enter</kbd>
                            <span>New line without sending</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Escape</kbd>
                            <span>Cancel streaming response</span>
                        </div>
                    </div>

                    <div class="shortcuts-category">
                        <h4>Navigation & Search</h4>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>K</kbd>
                            <span>Open conversation browser</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>F</kbd>
                            <span>Search within conversation</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>U</kbd>
                            <span>Toggle file browser</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Escape</kbd>
                            <span>Close search / file browser</span>
                        </div>
                    </div>

                    <div class="shortcuts-category">
                        <h4>Tab Management</h4>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>N</kbd>
                            <span>New tab</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>X</kbd>
                            <span>Close current tab</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>Tab</kbd>
                            <span>Next tab</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Tab</kbd>
                            <span>Previous tab</span>
                        </div>
                    </div>

                    <div class="shortcuts-category">
                        <h4>Window Management</h4>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>T</kbd>
                            <span>Toggle always on top</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>H</kbd>
                            <span>Hide REPL window</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>M</kbd>
                            <span>Minimize to tray</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>,</kbd>
                            <span>Open settings</span>
                        </div>
                    </div>

                    <div class="shortcuts-category">
                        <h4>Text Editing</h4>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>A</kbd>
                            <span>Select all text</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>Z</kbd>
                            <span>Undo</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>Y</kbd>
                            <span>Redo</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Up</kbd> / <kbd>Down</kbd>
                            <span>Navigate message history</span>
                        </div>
                    </div>

                    <div class="shortcuts-category">
                        <h4>Conversation Actions</h4>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>S</kbd>
                            <span>Save/Export conversation</span>
                        </div>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 2rem;">
                    <p><strong>Pro Tip:</strong> All keyboard shortcuts are also displayed in button tooltips throughout the application. Hover over any button to see its shortcut!</p>
                </div>
            </section>

            <!-- Troubleshooting -->
            <section id="troubleshooting" class="content-section">
                <h2>Troubleshooting</h2>

                <div class="subsection">
                    <h3>Common Issues</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Connection Problems</h4>
                            <p><strong>"API connection failed"</strong></p>
                            <ul>
                                <li>Check internet connection</li>
                                <li>Verify API key is correct and has credits</li>
                                <li>Confirm AI service is available</li>
                                <li>Check firewall/proxy settings</li>
                                <li>If using PKI, verify certificates are valid</li>
                                <li>Check SSL verification setting in Advanced settings</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>File Upload Issues</h4>
                            <p><strong>Files not processing</strong></p>
                            <ul>
                                <li>Check file size (max 50MB)</li>
                                <li>Verify file type is supported</li>
                                <li>Ensure API key is configured (embeddings require API)</li>
                                <li>Check logs for error messages</li>
                                <li>Try smaller files first</li>
                                <li>Verify the RAG data folder exists at <code>%APPDATA%\Specter\rag\</code></li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Performance Issues</h4>
                            <p><strong>Slow responses</strong></p>
                            <ul>
                                <li>Check network speed</li>
                                <li>Try a different or smaller AI model</li>
                                <li>Reduce conversation length (start a new tab)</li>
                                <li>Disable tools if not needed (Settings &gt; Tools)</li>
                                <li>Restart the application</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4>Skills Not Working</h4>
                            <p><strong>AI not using tools</strong></p>
                            <ul>
                                <li>Check that tool calling is enabled in Settings &gt; Tools</li>
                                <li>Verify AI intent classification is enabled in Advanced settings</li>
                                <li>Some skills require Outlook (email, calendar)</li>
                                <li>Web search requires either DuckDuckGo (free) or Tavily API key</li>
                                <li>Check <code>/skills</code> to see which skills are active</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3>Log Files</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Log Locations</h4>
                            <ul>
                                <li><strong>Application Log:</strong> <code>%APPDATA%\Specter\logs\specter.log</code></li>
                                <li><strong>Crash Log:</strong> <code>%APPDATA%\Specter\logs\crash.log</code></li>
                                <li><strong>RAG Log:</strong> <code>%APPDATA%\Specter\rag\rag_pipeline.log</code></li>
                            </ul>
                            <div class="info-box" style="margin-top: 1rem;">
                                <p><strong>Quick Access:</strong> Open File Explorer and type <code>%APPDATA%\Specter\logs</code> in the address bar to navigate directly to the logs folder.</p>
                            </div>
                        </div>

                        <div class="feature-card">
                            <h4>Using Logs</h4>
                            <ol class="step-list">
                                <li>Enable debug mode in Settings &gt; Advanced for verbose logging</li>
                                <li>Reproduce the issue</li>
                                <li>Open the latest log file</li>
                                <li>Look for ERROR or WARNING entries</li>
                                <li>Note timestamps around when the issue occurred</li>
                                <li>Check <code>crash.log</code> for C-level crashes (segfaults)</li>
                            </ol>
                        </div>

                        <div class="feature-card">
                            <h4>Viewing Logs from Command Line</h4>
                            <div class="code-block">
                                <pre><code># PowerShell: View last 100 lines
Get-Content "$env:APPDATA\Specter\logs\specter.log" -Tail 100

# PowerShell: Live tail
Get-Content "$env:APPDATA\Specter\logs\specter.log" -Wait -Tail 50

# Check for crashes
Get-Content "$env:APPDATA\Specter\logs\crash.log"</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3>Reset & Recovery</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Reset Settings</h4>
                            <p>If Specter becomes misconfigured, you can reset settings:</p>
                            <ol class="step-list">
                                <li>Close Specter completely</li>
                                <li>Navigate to <code>%APPDATA%\Specter\configs\</code></li>
                                <li>Rename or delete <code>settings.json</code></li>
                                <li>Restart Specter - default settings will be recreated</li>
                            </ol>
                            <div class="warning-box" style="margin-top: 1rem;">
                                <p><strong>Warning:</strong> This will reset all settings including your API key. Make a backup of settings.json first if you want to preserve any values.</p>
                            </div>
                        </div>

                        <div class="feature-card">
                            <h4>Database Recovery</h4>
                            <p>If conversations are corrupted:</p>
                            <ul>
                                <li><strong>Database Location:</strong> <code>%APPDATA%\Specter\db\conversations.db</code></li>
                                <li><strong>Backup First:</strong> Copy the .db file before any recovery</li>
                                <li><strong>Fresh Start:</strong> Delete the database file and restart</li>
                                <li><strong>Migrations:</strong> The app automatically runs migrations on startup</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Getting Help -->
            <section id="getting-help" class="content-section">
                <h2>Getting Help</h2>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>Documentation</h4>
                        <ul>
                            <li><a href="index.html">User Guide</a> - This document</li>
                            <li><a href="technical.html">Technical Documentation</a> - Architecture and internals</li>
                            <li><a href="https://github.com/ghost-ng/Ghostman" target="_blank">GitHub Repository</a></li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>In-App Help</h4>
                        <ul>
                            <li><strong>/help</strong> - Type in chat for quick command reference</li>
                            <li><strong>/skills</strong> - View available AI skills</li>
                            <li><strong>Tooltips:</strong> Hover over any button for shortcut hints</li>
                            <li><strong>Avatar Menu:</strong> Right-click avatar &gt; Help</li>
                        </ul>
                    </div>

                    <div class="feature-card">
                        <h4>Reporting Issues</h4>
                        <ol class="step-list">
                            <li>Visit <a href="https://github.com/ghost-ng/Ghostman/issues" target="_blank">GitHub Issues</a></li>
                            <li>Search for existing reports</li>
                            <li>Create new issue with details</li>
                            <li>Include logs and screenshots</li>
                            <li>Mention your Specter version and Windows version</li>
                        </ol>
                    </div>
                </div>

                <div class="info-box">
                    <p><strong>Ready to Start!</strong> Specter is your AI companion for desktop productivity with AI skills, avatar personas, context-aware file search, collections, and beautiful theming. For technical details about the architecture, visit the <a href="technical.html">Technical Documentation</a>.</p>
                </div>
            </section>
        </main>
    </div>

    <script src="js/help.js"></script>
</body>
</html>
